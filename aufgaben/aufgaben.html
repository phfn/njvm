<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>KSP Aufgaben</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="./fonts/fontawesome/css/rall.css">
</head>
<body class="article">
<div id="header">
<h1>KSP Aufgaben</h1>
<div id="toc" class="toc">
<div id="toctitle">Inhaltsverzeichnis</div>
<ul class="sectlevel1">
<li><a href="#_ksp_vorbereitung_zum_praktikum">KSP Vorbereitung zum Praktikum</a></li>
<li><a href="#_ksp_aufgabe_0">KSP Aufgabe 0</a>
<ul class="sectlevel2">
<li><a href="#_hinweise_aufgabe_0">Hinweise Aufgabe 0</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_1">KSP Aufgabe 1</a>
<ul class="sectlevel2">
<li><a href="#_testprogramme">Testprogramme</a></li>
<li><a href="#_hinweise_aufgabe_1">Hinweise Aufgabe 1</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_2">KSP Aufgabe 2</a>
<ul class="sectlevel2">
<li><a href="#_hinweise_aufgabe_2">Hinweise Aufgabe 2</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_3">KSP Aufgabe 3</a>
<ul class="sectlevel2">
<li><a href="#_teilaufgabe_interaktiver_debugger">Teilaufgabe: Interaktiver Debugger</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_4">KSP Aufgabe 4</a>
<ul class="sectlevel2">
<li><a href="#_neue_instruktionen_der_vm">Neue Instruktionen der VM</a></li>
<li><a href="#_der_ninja_compiler">Der Ninja-Compiler</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_5">KSP Aufgabe 5</a></li>
<li><a href="#_ksp_aufgabe_6">KSP Aufgabe 6</a></li>
<li><a href="#_ksp_aufgabe_7">KSP Aufgabe 7</a>
<ul class="sectlevel2">
<li><a href="#_vollständige_liste_der_instruktionen_der_vm">Vollständige Liste der Instruktionen der VM</a></li>
<li><a href="#_aufgaben_für_tests">Aufgaben für Tests</a></li>
</ul>
</li>
<li><a href="#_ksp_aufgabe_8">KSP Aufgabe 8</a>
<ul class="sectlevel2">
<li><a href="#_vorbereitungen">Vorbereitungen</a></li>
<li><a href="#_garbage_collector">Garbage Collector</a></li>
<li><a href="#_testprogramme_2">Testprogramme</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_ksp_vorbereitung_zum_praktikum">KSP Vorbereitung zum Praktikum</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Installieren Sie Linux auf Ihrem Rechner (Tipp: Ubuntu). Machen Sie sich mit dem Installieren von Paketen vertraut (<code>apt</code>). Sie benötigen einen Editor Ihrer Wahl, sowie die üblichen Entwicklungswerkzeuge (gcc, bison, flex).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Anmerkung"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Alternative &#8594; Verwendung der vorbereiteten VirtualBox VM</strong></p>
</div>
<div class="paragraph">
<p>Unter <a href="https://hbx.fhhrz.net/getlink/fiW5bCoF7czq1FRKtUCTwoC8/debs.ova" class="bare">https://hbx.fhhrz.net/getlink/fiW5bCoF7czq1FRKtUCTwoC8/debs.ova</a> können Sie ein VM Image für Oracle VirtualBox (<a href="https://www.virtualbox.org/" class="bare">https://www.virtualbox.org/</a>) herunterladen, das alle Anforderungen zur Entwicklung der Ninja VM erfüllt. Wenn Sie bereits Linux auf Ihrem System installiert haben, empfiehlt es sich trotzdem die bereitgestellte VM zu verwenden, da dort alle benötigten Pakete installiert sind. Beachten Sie bitte: Wir geben keinen Support für Probleme die auf Eigeninstallationen auftreten. D.h. Benutzen Sie Ihr eigenes System, kümmern Sie sich bitte selbst darum, dass alles läuft. Was in der Regel heißt bestimmte Softwarepakete zu installieren.</p>
</div>
<div class="paragraph">
<p>Das Passwort für den Benutzer (<code>student</code>) der bereitgestellten Virtualbox VM: <code>student</code></p>
</div>
<div class="paragraph">
<p>Hier noch eine Liste an installierten/verfügbaren IDEs und Editoren:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Atom (Open Source Editor und IDE)</p>
</li>
<li>
<p>Visual Studio Code (Open Source Editor und IDE)</p>
</li>
<li>
<p>Sublime Text 3 (installiert, keine Lizenz)</p>
</li>
<li>
<p>VIM (Editor, IDE, &#8230;&#8203;)</p>
</li>
<li>
<p>CLION (Jetbrains, muss selbstständig installiert werden. Lizenz kann kostenlos geholt werden: <a href="https://www.jetbrains.com/shop/eform/students" class="bare">https://www.jetbrains.com/shop/eform/students</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generell sollte für diesen Kurs auch MacOSX oder ein Windows 10 mit WSL2 ausreichen, solange alle notwendigen Pakete installiert sind. Hier sind sie jedoch auch aus sich alleine gestellt.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Editieren Sie folgendes Programm mit einer IDE / einem Editor Ihrer Wahl in einer Datei <code>hello.c</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="cp">#include &lt;stdio.h&gt;
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Hello, world!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Übersetzen und binden Sie das Programm mit der Kommandozeile</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>gcc <span class="nt">-g</span> <span class="nt">-Wall</span> <span class="nt">-std</span><span class="o">=</span>c99 <span class="nt">-pedantic</span> <span class="nt">-o</span> hello hello.c</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Lassen Sie das Programm laufen mit der Kommandozeile</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>./hello</code></pre>
</div>
</div>
<div class="paragraph">
<p>Es muss den Text "Hello, world!" (ohne die Anführungszeichen, mit einem Zeilenumbruch am Ende) ausgeben.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_0">KSP Aufgabe 0</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Entwerfen Sie ein C-Programm <code>njvm.c</code>, das nur aus der Funktion <code>int main(int argc, char * argv[])</code> besteht und beim Aufruf die beiden Strings <code>Ninja Virtual Machine started\n</code> und <code>Ninja Virtual Machine stopped\n</code> ausgibt.</p>
</li>
<li>
<p>Modifizieren Sie Ihr Programm aus 1. so, dass es alle Kommandozeilenargumente vor den beiden Strings ausgibt.</p>
</li>
<li>
<p>Modifizieren Sie Ihr Programm aus 1. so, dass das Programm sowohl sinnvoll auf die Kommandozeilenargumente <code>--version</code> und <code>--help</code> reagiert als auch unbekannte Argumente zurückweist. Sie können die folgende Referenzimplementierung als Vorbild für das Verhalten Ihres Programms nehmen (machen Sie das Programm nach dem Download ggf. mit <code>chmod +x njvm</code> ausführbar, bevor Sie es mit <code>./njvm</code> aufrufen): <a href="a0/njvm">njvm</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_hinweise_aufgabe_0">Hinweise Aufgabe 0</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verwenden Sie den C-Compiler <code>gcc</code> mit den Compilerschaltern <code>-g -Wall -std=c99 -pedantic</code> und beheben Sie alle Fehler und Warnungen, die der Compiler evtl. ausgibt. Wenn Sie eine Warnung ignorieren wollen, müssen Sie EXAKT erklären können, warum diese spezielle Warnung in diesem speziellen Fall wirklich unschädlich ist.</p>
</li>
<li>
<p>Sie beginnen bereits in dieser Übung, das Programm zu entwickeln, das Sie am Ende des Semesters als Ihre zweite Hausübung abgeben werden und das dann einen erheblichen Umfang haben wird. Bemühen Sie sich also schon jetzt um Klarheit in der Programmierung, ausreichend viele und aussagekräftige Kommentare, konsistentes Einrücken, usw.!</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Beispielausgabe Referenzimplementierung <code>njvm</code></div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>./njvm
Ninja Virtual Machine started
Ninja Virtual Machine stopped
<span class="nv">$ </span>./njvm <span class="nt">--help</span>
usage: ./njvm <span class="o">[</span>option] <span class="o">[</span>option] ...
  <span class="nt">--version</span>        show version and <span class="nb">exit</span>
  <span class="nt">--help</span>           show this <span class="nb">help </span>and <span class="nb">exit</span>
<span class="nv">$ </span>./njvm <span class="nt">--version</span>
Ninja Virtual Machine version 0 <span class="o">(</span>compiled Sep 23 2015, 10:36:52<span class="o">)</span>
<span class="nv">$ </span>./njvm <span class="nt">--foo</span>
unknown <span class="nb">command </span>line argument <span class="s1">'--foo'</span>, try <span class="s1">'./njvm --help'</span>
<span class="nv">$ </span>./njvm bar
unknown <span class="nb">command </span>line argument <span class="s1">'bar'</span>, try <span class="s1">'./njvm --help'</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_1">KSP Aufgabe 1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Konstruieren Sie die Ninja-VM Version 1, die die in <a href="#a1_instructions">Tabelle 1</a> gelisteten Instruktionen ausführen kann. Jede Instruktion eines Programms wird in einem <code>unsigned int</code> gespeichert, wobei der Opcode (die Zahl, die in der Tabelle hinter jeder Instruktion steht) in den obersten 8 Bits des <code>unsigned int</code> abgelegt wird. Die restlichen 24 Bits dienen zur Aufnahme eines Immediate-Wertes. Der wird im Augenblick nur bei der Instruktion <code>pushc</code> benötigt, wo er den auf den Stack zu legenden Wert darstellt.</p>
</div>
<table id="a1_instructions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Tabelle 1. VM Instruktionen</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruktion</th>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Stack Layout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>halt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushc &lt;const&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1+n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1-n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1*n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>div</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1/n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1%n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wrint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdchr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wrchr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Den Effekt einer jeden Instruktion auf den Stack listet die Spalte Stack Layout in der <a href="#a1_instructions">Tabelle 1</a>. Punkte <code>&#8230;&#8203;&#8230;&#8203;</code> in der Tabelle stehen jeweils für den durch die Instruktion nicht veränderten Stackinhalt; der <code>Top-of-Stack</code> befindet sich jeweils rechts. Die Operanden für arithmetische Operationen sind immer ganze Zahlen, genauso wie die bei <code>rdint</code> und <code>rdchr</code> eingelesenen bzw. bei <code>wrint</code> und <code>wrchr</code> ausgegebenen Werte.</p>
</div>
<div class="sect2">
<h3 id="_testprogramme">Testprogramme</h3>
<div class="paragraph">
<p>Die drei hier gelisteten Programme sollen fest in die VM einprogrammiert werden. Der Benutzer kann durch Eingabe eines Kommandozeilenargumentes beim Aufruf der VM eines der Programme auswählen, das dann in den Programmspeicher der VM kopiert wird. Nach dem Anlaufen der VM wird das Programm erst in einer lesbaren Form aufgelistet; eine mögliche Darstellung können Sie der Referenzimplementierung entnehmen. Anschließend wird es ausgeführt. Beachten Sie bitte, dass "Auflisten" und "Ausführen" zwei getrennte Aktionen auf dem Programm sind, die strikt hintereinander passieren sollen.</p>
</div>
<div class="sect3">
<h4 id="_programm_1">Programm 1</h4>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<colgroup>
<col style="width: 63.6363%;">
<col style="width: 36.3637%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ninja Programmfragment</th>
<th class="tableblock halign-left valign-top">Instruktionssequenz</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">    <span class="n">writeInteger</span><span class="p">((</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">6</span><span class="p">));</span>
    <span class="n">writeCharacter</span><span class="p">(</span><span class="sc">'\n'</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">	<span class="n">pushc</span>	<span class="mi">3</span>
	<span class="n">pushc</span>	<span class="mi">4</span>
	<span class="n">add</span>
	<span class="n">pushc</span>	<span class="mi">10</span>
	<span class="n">pushc</span>	<span class="mi">6</span>
	<span class="n">sub</span>
	<span class="n">mul</span>
	<span class="n">wrint</span>
	<span class="n">pushc</span>	<span class="mi">10</span>
	<span class="n">wrchr</span>
	<span class="n">halt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_programm_2">Programm 2</h4>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<colgroup>
<col style="width: 63.6363%;">
<col style="width: 36.3637%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ninja Programmfragment</th>
<th class="tableblock halign-left valign-top">Instruktionssequenz</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">    <span class="n">writeInteger</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nf">readInteger</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">writeCharacter</span><span class="p">(</span><span class="sc">'\n'</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">	<span class="n">pushc</span>	<span class="o">-</span><span class="mi">2</span>
	<span class="n">rdint</span>
	<span class="n">mul</span>
	<span class="n">pushc</span>	<span class="mi">3</span>
	<span class="n">add</span>
	<span class="n">wrint</span>
	<span class="n">pushc</span>	<span class="sc">'\n'</span>
	<span class="n">wrchr</span>
	<span class="n">halt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_programm_3">Programm 3</h4>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<colgroup>
<col style="width: 63.6363%;">
<col style="width: 36.3637%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ninja Programmfragment</th>
<th class="tableblock halign-left valign-top">Instruktionssequenz</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">    <span class="n">writeInteger</span><span class="p">(</span><span class="n">readCharacter</span><span class="p">());</span>
    <span class="n">writeCharacter</span><span class="p">(</span><span class="sc">'\n'</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c">	<span class="n">rdchr</span>
	<span class="n">wrint</span>
	<span class="n">pushc</span>	<span class="sc">'\n'</span>
	<span class="n">wrchr</span>
	<span class="n">halt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Hier ist wieder die Referenzimplementierung:
<a href="a1/njvm">njvm</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hinweise_aufgabe_1">Hinweise Aufgabe 1</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Die Compilerschalter sind wie in Aufgabe 0 auf <code>-g -Wall -std=c99 -pedantic</code> zu setzen.</p>
</li>
<li>
<p>Ihre VM benötigt einen Programmspeicher und einen Stack. Beide können Sie global definieren, damit Sie von überall darauf zugreifen können. Wählen Sie die Basis-Datentypen mit Bedacht, insbesondere im Hinblick auf vorzeichenbehaftete (<code>signed</code>) vs. vorzeichenlose (<code>unsigned</code>) Größen!</p>
</li>
<li>
<p>Ihre VM wird zwei Interpreter für den Programmcode beinhalten: einen für das <strong>Listen des Programms</strong> und einen für die eigentliche <strong>Ausführung</strong>. Beide sind strukturell gleich aufgebaut: eine Schleife (<em>worüber?</em>) und darin eine Mehrfachverzweigung (<em>wozu?</em>). Beginnen Sie mit dem Programmlister - wenn Sie den haben, ist der Interpretierer für die Ausführung nicht mehr schwer. Beachten Sie aber die zwei unterschiedlichen Abbruchkriterien in den beiden Interpretierern (<em>welche genau?, und warum sind die eigentlich unterschiedlich?</em>).</p>
</li>
<li>
<p>Ihr Programm darf unter keinen Umständen abstürzen! Natürlich gibt es Fehlersituationen, in denen Sie das Programm nicht vernünftig weiterlaufen lassen können - dann geben Sie eine verständliche Fehlermeldung aus und beenden das Programm. Eine solche Situation betrifft beispielsweise das Teilen durch 0, eine andere den Stack-Überlauf bzw. -Unterlauf (<em>wann können diese beiden Fehler auftreten?</em>).</p>
</li>
<li>
<p>Sie müssen die drei Programme <em>manuell</em>, also <em>per Hand</em> assemblieren, solange es noch keinen Assembler gibt.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Wie macht man das?<br>
Nehmen wir als Beispiel <code>pushc 3</code> &#8594; Der <strong>Opcode</strong> für <code>pushc</code> ist <code>1</code> (er kommt in die höchsten 8 Bits); die <strong>Immediate-Konstante</strong> ist <code>3</code> (sie kommt in die untersten 24 Bits). Also ist das Bitmuster des Befehls (4 Bytes) <code>00000001 00000000 00000000 00000011</code>, oder hexadezimal <code>0x01000003</code>. Auf gar keinen Fall arbeitet man hier mit Dezimalzahlen! Es geht aber viel eleganter: verwenden Sie den C-Präprozessor, um eine lesbare Codierung der drei kleinen Programme zu ermöglichen! Beispielsweise könnte der Anfang des ersten Programms im C-Quelltext lauten:</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">code1</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">(</span><span class="n">PUSHC</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="n">IMMEDIATE</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">(</span><span class="n">PUSHC</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="n">IMMEDIATE</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="p">(</span><span class="n">ADD</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">),</span>
<span class="p">...</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>mit den entsprechenden Definitionen für die Opcodes, z.B.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="cp">#define PUSHC 1
#define ADD 2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>und für das Kodieren des Immediate-Wertes (<em>warum braucht man das?</em>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="cp">#define IMMEDIATE(x) ((x) &amp; 0x00FFFFFF)</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Der Immediate-Wert kann auch <strong>negativ</strong> sein. Vielleicht haben Sie Verwendung für dieses Makro:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="cp">#define SIGN_EXTEND(i) ((i) &amp; 0x00800000 ? (i) | 0xFF000000 : (i))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Was macht das Makro eigentlich? Und wie genau funktioniert es?</em></p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Achtung"></i>
</td>
<td class="content">
ACHTUNG: Es ist unbedingt erforderlich, die Makros aus 5. und 6. genau zu verstehen! Machen Sie sich die Wirkungsweise an Beispielen klar und rechnen Sie damit, im Praktikum dazu befragt zu werden!
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_2">KSP Aufgabe 2</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ab dieser Aufgabe haben Sie einen <a href="a2/nja">Assembler</a> zur Verfügung, damit das lästige Kodieren der Befehle nicht mehr per Hand ausgeführt werden muss. Denken Sie daran, dass auch das Programm <code>nja</code> ausführbar sein muss! Schreiben Sie die drei kleinen Testprogramme aus der vorigen Aufgabe in jeweils eine Datei, die die Endung <code>.asm</code> haben sollte. Lassen Sie die Programme assemblieren; die entstehenden Dateien sollten die Endung <code>.bin</code> haben. Inspizieren Sie diese Binärdateien mit dem Kommando <code>hexdump -C</code>. Versuchen Sie genau zu erklären, wie die beobachtete Ausgabe zustande kommt! Studieren Sie dazu die <a href="a2/binformat">Beschreibung des Ninja-Binärformats</a>.</p>
</li>
<li>
<p>Jetzt ändern Sie Ihre VM vom vorigen Aufgabenblatt so ab, dass das Binärprogramm aus einer Datei in den Programmspeicher geladen wird.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>a) Der Name des zu ladenden Programms soll als Kommandozeilenargument übergeben werden.</p>
</div>
<div class="paragraph">
<p>b) Bevor Sie etwas mit dem Inhalt der Datei tun können, müssen Sie die Datei <code>öffnen</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">FILE</span> <span class="o">*</span><span class="nf">fopen</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">mode</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>c) Was Sie mit dem Inhalt einer Ninja-Binärdatei tun müssen, um das darin enthaltene Programm starten zu können, steht ebenfalls in der Beschreibung des Ninja-Binärformats .</p>
</div>
<div class="paragraph">
<p>d) Sie werden die Funktion <code>fread()</code> zum Lesen aus einer Datei brauchen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">size_t</span> <span class="nf">fread</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nmemb</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>e) Ebenso brauchen Sie die Funktion <code>malloc()</code> zur Speicheranforderung:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">void</span> <span class="o">*</span><span class="nf">malloc</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>f) Wenn Sie alle Informationen aus der Datei verwertet haben, wird die Datei wieder geschlossen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">int</span> <span class="nf">fclose</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">fp</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ergänzen Sie nun Ihre VM auf die Version 2, in dem Sie die neuen Instruktionen aus <a href="#a2_instructions">Tabelle 2</a> implementieren. Eine Diskussion von globalen Variablen und den zugehörigen Instruktionen finden Sie <a href="a2/globalvars">hier</a>, die Diskussion von lokalen Variablen und Stackframes mit ihren Instruktionen gibt&#8217;s <a href="a2/localvars">hier</a>.</p>
</li>
<li>
<p>Prüfen Sie nun das Funktionieren Ihrer VM durch Assemblieren und Ausführen der drei kleinen Programme aus Aufgabenteil 1 sowie der beiden Testprogramme <a href="a2/prog1.asm">prog1.asm</a> und <a href="a2/prog2.asm">prog2.asm</a>. Es wird dringend empfohlen, mindestens fünf weitere selbstgewählte Berechnungen im Stackmaschinen-Assembler zu programmieren und ausführen zu lassen. Sie sollten in der Lage sein, zu jedem Zeitpunkt der Ausführung den Stack aufzeichnen zu können!</p>
</li>
<li>
<p>Und hier wie immer die Referenzimplementierung: <a href="a2/njvm">njvm</a></p>
</li>
</ol>
</div>
<table id="a2_instructions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Tabelle 2. VM Instruktionen</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruktion</th>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Stack Layout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushg &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popg  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asf   &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>13</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rsf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>14</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushl &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popl  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_hinweise_aufgabe_2">Hinweise Aufgabe 2</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Alle benötigten Bibliotheksfunktionen kann man im Online-Manual nachschlagen. Das ruft man mit dem Kommando <code>man</code> auf. In diesem Manual stehen auch alle Kommandos drin, die das System kennt. Wenn man also z.B. nicht weiß, wie das Manual funktioniert: <code>man man</code> hilft. Das Manual ist sehr "dicht" geschrieben; in jedem Halbsatz stehen mehrere wichtige Informationen drin. Studieren Sie deshalb die Manual-Einträge genau; nur überfliegen reicht nicht!</p>
</li>
<li>
<p>Vergessen Sie nicht, alle Rückgabewerte zu prüfen; die aufgerufene Funktion könnte aus diversen Gründen fehlgeschlagen sein (mögliche Ursachen stehen ebenfalls im Manual).</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_3">KSP Aufgabe 3</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implementieren Sie die neuen Instruktionen zum Testen von Zahlen (<code>eq</code>, <code>ne</code>, <code>lt</code>, <code>le</code>, <code>gt</code>, <code>ge</code>), die die numerischen Vergleiche (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&#8656;</code>, <code>&gt;</code>, <code>&gt;=</code>) repräsentieren. Die Auswirkungen auf den Stack können Sie wieder in der Spalte Stack Layout der <a href="#a3_instructions">Tabelle 3</a> sehen. Das Ergebnis eines Vergleichs, ein Boole&#8217;scher Wert, wird durch die ganze Zahl <code>0</code> für <code>false</code> bzw. <code>1</code> für <code>true</code> dargestellt. Natürlich gibt&#8217;s einen <a href="a3/nja">Assembler</a> , der auch die neuen Instruktionen assemblieren kann.</p>
</li>
</ol>
</div>
<table id="a3_instructions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Tabelle 3. VM Instruktionen</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruktion</th>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Stack Layout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>17</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1==n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ne</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>18</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1!=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>19</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&lt;n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>le</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&lt;=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>21</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&gt;n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>22</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&gt;=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jmp   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>23</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brf   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... b  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brt   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... b  -&gt;  ...</code></p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Nehmen Sie sich dann den unbedingten Sprung <code>jmp</code> sowie die beiden bedingten Sprünge (<em>branch on false</em> <code>brf</code> und <em>branch on true</em> <code>brt</code>) vor. Der Immediate-Wert in diesen Instruktionen gibt das Sprungziel an. Die bedingten Sprünge prüfen das oberste Stack-Element, um zu entscheiden, ob gesprungen wird. Wenn nicht gesprungen wird, kommt die nächste Instruktion zur Ausführung. Die Auswirkungen auf den Stack können Sie wieder in der Spalte Stack Layout in <a href="#a3_instructions">Tabelle 3</a> sehen. Der Assembler hat eine neue Kommandozeilenoption <code>--map</code>; was kann man eigentlich mit der anfangen?</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_teilaufgabe_interaktiver_debugger">Teilaufgabe: Interaktiver Debugger</h3>
<div class="paragraph">
<p>Nun kommt die erste etwas größere Aufgabe: <strong>ein interaktiver Debugger</strong> für Ihre VM. Die Instruktionen werden komplizierter, die auszuführenden Programme umfangreicher - man wünscht sich, mehr über den inneren Zustand der VM zu erfahren, speziell wenn Fehler auftreten.</p>
</div>
<div class="paragraph">
<p>a) Im Gegensatz zu den früheren Aufgaben soll ab jetzt das Programm nach dem Laden nicht mehr automatisch gelistet werden, sondern einfach nur ausgeführt werden. Wenn man aber die VM mit dem Kommandozeilenschalter <code>--debug</code> startet, soll sich nach dem Laden des Programms der interaktive Debugger melden und auf Kommandos warten, die er dann ausführt.</p>
</div>
<div class="paragraph">
<p>b) Schreiben Sie eine kurze, aber exakte Spezifikation, welche Kommandos Ihr Debugger verstehen soll. Als kleiner Hinweis für diejenigen, die sich wenig unter einem solchen Teil vorstellen können: Was wünscht man sich, um den Programmverlauf verfolgen oder vielleicht sogar beeinflussen zu können? Lassen Sie doch einfach mal dieses <a href="a3/prog1.asm">Beispielprogramm 1</a> laden und stellen Sie sich vor, es würde nicht das gewünschte Ergebnis (den größten gemeinsamen Teiler zweier positiver Zahlen) liefern. Natürlich können Sie das auch ganz praktisch ausprobieren, indem Sie irgendeine Instruktion (z.B. das zweite <code>brf</code>) in eine andere Instruktion (z.B. <code>brt</code>) umändern, oder noch besser: von Ihrem anderen Grupenmitglied umändern lassen, ohne dass Sie wissen, was da passiert ist. Was braucht man dann für Hilfsmittel, um den Fehler zu lokalisieren?</p>
</div>
<div class="paragraph">
<p>Als Minimalmenge müssen die Kommandos: <em>Anzeigen des Stacks</em>,  <em>Anzeigen der statischen Daten</em>,  <em>Listen des Programms</em>, <em>Ausführen des nächsten Befehls</em>, <em>Weiterlaufen ohne Anhalten</em> und <em>Verlassen der VM</em> aufgenommen werden.</p>
</div>
<div class="paragraph">
<p>Sehr zweckmäßig ist auch das <em>Setzen eines Breakpoints</em> (wenn das Programm bei der Ausführung später dort vorbeikommt, hält es an und der Debugger übernimmt die Kontrolle). Anregungen können Sie sich natürlich wie immer auch von der Referenzimplementierung holen: <a href="a3/njvm">njvm</a></p>
</div>
<div class="paragraph">
<p>c) Implementieren Sie nun die von Ihnen vorgesehen Kommandos des Debuggers. Prüfen Sie mit dem <a href="a3/prog1.asm">Beispielprogramm 1</a> und <a href="a3/prog2.asm">Beispielprogramm 2</a> sowie anderen, von Ihnen geschriebenen Testprogrammen, ob der Debugger das leistet, was Sie sich von ihm erwarten. Wahrscheinlich fallen Ihnen noch Verbesserungen ein - dann gehen Sie zurück zu b).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_4">KSP Aufgabe 4</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jetzt wird&#8217;s ernst&#8230;&#8203; ;-)
Mit der Lösung dieser Aufgabe steht Ihnen das komplette Ninja (mit Ausnahme der Array- und Record-Objekte) zur Verfügung. Sie können damit z.B. die folgenden Programme ausführen:
a) <a href="a4/prog10.nj">ggT</a>
b) <a href="a4/prog11.nj">n! rekursiv</a>
c) <a href="a4/prog12.nj">n! iterativ</a></p>
</div>
<div class="paragraph">
<p>Aber schön der Reihe nach&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_neue_instruktionen_der_vm">Neue Instruktionen der VM</h3>
<table id="a4_instructions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Tabelle 4. VM Instruktionen</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruktion</th>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Stack Layout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call  &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>26</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... ra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>27</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... ra  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>drop  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>28</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... a0 a1...an-1  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>29</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... rv</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>30</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... rv  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>31</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n -&gt; ... n n</code></p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Hier ist eine Diskussion der Instruktionen zum Unterprogrammaufruf und in <a href="#a4_instructions">Tabelle 4</a> eine Liste aller Instruktionen der VM dieser Version.</p>
</li>
<li>
<p>Realisieren Sie Unterprogrammsprünge und -rücksprünge mit den Instruktionen <code>call</code> und <code>ret</code>. Hier ist ein <a href="a4/prog01.asm">Testprogramm ohne Argumente und ohne Rückgabewert</a>. Sie sollten die Ausführung mit Hilfe Ihres Debuggers im Einzelschrittverfahren genau verfolgen können.</p>
</li>
<li>
<p>Implementieren Sie die Instruktion <code>drop</code> und testen Sie den Zugriff auf die Argumente einer Prozedur mit diesem <a href="a4/prog02.asm">Testprogramm</a>.</p>
</li>
<li>
<p>Fügen Sie das Rückgaberegister zur Maschinenarchitektur hinzu und implementieren Sie die Instruktionen <code>pushr</code> und <code>popr</code>. Sie können die Rückgabe eines Wertes mit diesem <a href="a4/prog03.asm">Testprogramm</a> überprüfen.</p>
</li>
<li>
<p>Dann sollte schließlich dieses <a href="a4/prog04.asm">Testprogramm</a> ohne weitere Arbeit funktionieren.</p>
</li>
<li>
<p>Implementieren Sie die Instruktion <code>dup</code>, die den obersten Stackeintrag dupliziert: <code>&#8230;&#8203; n -&#8594; &#8230;&#8203; n n</code></p>
</li>
<li>
<p>Der zu dieser Aufgabenstellung gehörende Assembler ist natürlich auch verfügbar: <a href="a4/nja">nja</a></p>
</li>
<li>
<p>Zu guter Letzt hier wieder die Referenzimplementierung: <a href="a4/njvm" class="bare">a4/njvm</a></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_der_ninja_compiler">Der Ninja-Compiler</h3>
<div class="paragraph">
<p>Nun gibt&#8217;s eine erste Version des <a href="a4/njc">Ninja-Compilers</a> - noch ohne Arrays, Records und anderen Schnickschnack, aber mit Prozeduren und Funktionen, Kontrollstrukturen, Zuweisungen und Ausdrücken. Die <a href="a4/grammar">Grammatik</a> zusammen mit den <a href="a4/tokens">Tokens</a> und den <a href="a4/predef">vordefinierten Bezeichnern</a> beschreibt, wie ein korrektes Ninja-Programm (in unserem noch etwas reduzierten Sprachumfang) aussieht.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Übersetzen Sie die drei ganz oben genannten Testprogramme mit Hilfe des Ninja-Compilers. Der Output ist Ninja-Assembler und kann z.B. mit einem Texteditor angeschaut werden. Versuchen Sie, jedes vom Compiler generierte Assembler-Statement einer Ninja-Quelltext-Anweisung zuzuordnen. Wenn Sie Fragen dazu haben, diskutieren Sie diese bitte mit den Betreuern im Praktikum!</p>
</li>
<li>
<p>Assemblieren Sie die drei Testprogramme und lassen Sie sie durch Ihre VM ausführen. Verfolgen Sie die Ausführung mit dem Debugger Ihrer VM.</p>
</li>
<li>
<p>Schreiben Sie mindestens fünf weitere Testprogramme, entweder in Ninja oder in Assembler, um sicherzugehen, dass die VM korrekt funktioniert. Loten Sie dabei auch Konstruktionen aus, die bisher nicht Bestandteil der Tests waren. Ein Beispiel: Kann eine Funktion in ihrem Return-Statement eine andere Funktion aufrufen? Geht das auch geschachtelt?</p>
</li>
<li>
<p>Welche Sequenz von Instruktionen erzeugt der Compiler für das logische <code>und</code> und das logische <code>oder</code>? Erklären Sie genau, wie damit die Kurzschlussauswertung implementiert wird!</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_5">KSP Aufgabe 5</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Die Aufgabenstellung hier ist ganz einfach, bedingt aber einige Änderungen in der VM: Verlagern Sie die Rechenobjekte (bis jetzt sind das ja nur ganze Zahlen) auf den Heap und halten Sie in der Static Data Area, auf dem Stack und im Rückgabewertregister nur noch Zeiger in den Heap. Der Speicherplatz für die Objekte wird mit <code>malloc()</code> beschafft und innerhalb Ihres Programms nicht wieder freigegeben (das ist nämlich ohne Garbage Collector praktisch nicht möglich, und wie ein solches Teil funktioniert, werden wir in der Vorlesung erst später behandeln). Was genau sind unsere "Rechenobjekte"? Nun, das ist einfach: alle Objekte in der Static Data Area, alle Objekte auf dem Stack (mit Ausnahme von Rücksprungadressen und Framepointerwerten) sowie der Inhalt des Rückgabewertregisters. Alle anderen in der VM benutzten Dinge, wie z.B. Codespeicher, Programmzähler, Stackpointer und Framepointer sind keine Rechenobjekte: man kann sie von einem Ninja-Programm aus nicht unmittelbar beeinflussen.</p>
</li>
<li>
<p>Der Instruktionssatz ist gegenüber Aufgabe 4 unverändert; auch der <a href="a5/njc">Compiler</a> und der <a href="a5/nja">Assembler</a> bleiben exakt gleich (bis auf die Versionsnummern).</p>
</li>
<li>
<p>Ihr Debugger muss beim Anzeigen des Stacks kenntlich machen, welche Einträge Objektreferenzen und welche Einträge einfache Zahlen (Rücksprungadressen und gespeicherte Framepointer) sind.</p>
</li>
<li>
<p>Bauen Sie in Ihren Debugger eine Möglichkeit ein, Objekte zu inspizieren. Warum? Wenn Sie z.B. wissen wollen, welche Zahl ganz oben auf dem Stack liegt, dann lassen Sie sich den Stack anzeigen. Dort finden Sie aber nur die Adresse des Objektes auf dem Heap. Also wünschen Sie sich eine Möglichkeit, den Inhalt eines Objektes bei gegebener Objektadresse anzuschauen. Das wird im Übrigen auch in der übernächsten Aufgabe gebraucht, wenn in Objekten Referenzen auf andere Objekte gespeichert werden.</p>
</li>
<li>
<p>Hier wie immer die Referenzimplementierung:
<a href="a5/njvm">njvm</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_6">KSP Aufgabe 6</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In dieser Version der VM wollen wir als Rechenobjekte beliebig große ganze Zahlen zulassen. Diese neuen Rechenobjekte ersetzen die alten 32-Bit-Zahlen und haben ihren Speicherplatz ebenfalls auf dem Heap. Auf dem Stack, in der <em>Static Data Area</em> und im Rückgabewertregister stehen wie gehabt Zeiger auf die Rechenobjekte.</p>
</li>
<li>
<p>Die Algorithmen zum Rechnen mit beliebig großen ganzen Zahlen (<em>Multiple Precision Arithmetic</em>) sind entnommen aus [D. Knuth: <em>The Art of Computer Programming, Vol. 2, Seminumerical Algorithms</em>]. Eine Implementierung in C finden Sie <a href="a6/bigint.tar.gz">hier</a>. Entpacken Sie das Paket und studieren Sie die darin enthaltene Datei <a href="a6/BIGINT_README">README</a>. Bauen Sie das Paket und lassen Sie die Tests laufen! Machen Sie sich mit der Struktur der Zahlendarstellung vertraut! Hinweise: Jede Ziffer der Zahl ist ein Byte, d.h. die Zahldarstellung benutzt die Basis 256. Die Ziffern werden in einem genügend großen Array gespeichert, das zusammen mit der Größenangabe in einer Struktur ("Objekt") auf dem Heap steht.</p>
</li>
<li>
<p>Die <em>Multiple Precision Arithmetic</em> braucht eine winzige Support-Bibliothek, deren Funktionalität aber in Ihrer VM schon enthalten ist. Stellen Sie die benötigten Funktionen aus Ihrer VM zur Verfügung!</p>
</li>
<li>
<p>Studieren Sie das Benutzer-Programmierinterface und passen Sie Ihre VM an. Achten Sie darauf, ALLE Operationen mit Rechenobjekten der Bibliothek zu überlassen; dazu gehören auch die Vergleiche!</p>
</li>
<li>
<p>Der Instruktionssatz ist gegenüber Aufgabe 5 unverändert; auch der <a href="a6/njc">Compiler</a> und der <a href="a6/nja">Assembler</a> bleiben exakt gleich (bis auf die Versionsnummern).</p>
</li>
<li>
<p>Hier wie immer die Referenzimplementierung:
<a href="a6/njvm">njvm</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Aufgaben für Tests
a) Schreiben Sie ein kleines Ninja-Programm zur Berechnung von 100! = 1*2*3*...*100. Fällt Ihnen am Ergebnis etwas auf? Kann das denn überhaupt richtig sein?</p>
</div>
<div class="paragraph">
<p>b) Die Fibonacci-Folge ist definiert als <code>F(0) = 0, F(1) = 1, und F(n) = F(n-1) + F(n-2)</code> für alle <code>n &gt; 1</code>. Schreiben Sie ein kleines Ninja-Programm zur Berechnung von <code>F(100)</code>. Hinweis: Nur die iterative Version wird in annehmbarer Zeit zum Ergebnis führen!</p>
</div>
<div class="paragraph">
<p>c) Schreiben Sie ein kleines Ninja-Programm zur Berechnung der Summe aller Brüche \(\frac{1}{i}\) für \(i = 1, \dots, 100\) (die einhundertste "harmonische Zahl"). Das Ergebnis soll als exakter Bruch in gekürzter Darstellung angegeben werden. Hinweise: Halten Sie den Zähler und den Nenner des Ergebnisses in zwei verschiedenen Variablen. Wenn Sie einen neuen Term addieren wollen, müssen Sie die Brüche auf einen gemeinsamen Nenner bringen. Beim Kürzen (das Sie entweder bei jeder Rechnung oder aber einmal ganz am Ende aller Rechnungen durchführen können) leistet der größte gemeinsame Teiler gute Dienste! Können Sie die Zahl in Dezimalschreibweise mit z.B. 10 Stellen nach dem Komma ausgeben? Dazu sind nur Ganzzahloperationen nötig!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_7">KSP Aufgabe 7</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In dieser Aufgabenstellung soll das Rechnen mit Komponenten von Records und Arrays implementiert werden. Bei uns sind diese beiden Datenstrukturen (im Gegensatz zu C) "richtige Objekte", d.h. alle Instanzen von Records und Arrays leben auf dem Heap und werden nur über Zeiger zugegriffen. Das ist in Ninja nicht anders als in Java, und deshalb heissen die Komponenten auch "Instanzvariable". Um Ihnen einen Eindruck zu vermitteln, welche Berechnungen nun möglich sind, gibt&#8217;s hier drei Beispielprogramme:<br>
a) listrev.nj (Umdrehen einer Liste von Zahlen)<br>
b) twodim.nj (Belegen und Ausgeben eines zweidimensionalen Arrays)<br>
c) matinv.nj (Invertieren einer 2x2-Matrix mit Brüchen als Komponenten)<br>
<br>
1. Studieren Sie die neu hinzugekommenen Instruktionen des dann kompletten <a href="a7/instrs">Befehlssatzes</a> unserer VM, wobei Sie die <a href="a7/objects">Diskussion der Struktur von Objekten</a> und die <a href="a7/refcmp">Erläuterungen zu Referenzvergleichen</a> hinzuziehen sollten.<br>
<br>
2. Überprüfen Sie Ihr Verständnis der neuen Befehle! Vorschlag: Sie lassen das o.g. Programm matinv.nj übersetzen und entnehmen dem entstandenen Assemblerprogramm die Funktionen <a href="a7/newFraction.asm">newFraction</a> , <a href="a7/subFraction.asm">subFraction</a> und <a href="a7/newMatrix.asm">newMatrix</a> . Dann ergänzen Sie die Funktionen Zeile für Zeile um einen aussagekräftigen Kommentar, was da jeweils genau passiert. Sie sollten zu jedem Zeitpunkt den Stack der VM zeichnen können!<br>
<br>
3. Implementieren Sie die neuen Instruktionen. Sie können mit der Umsetzung der Objektstruktur beginnen. Es gibt ja zwei Sorten von Objekten: primitive Objekte (die eine Anzahl Bytes speichern) und zusammengesetzte Objekte (die eine Anzahl Objektreferenzen speichern). Das höchste Bit des Zählers, der in jedem Objekt enthalten ist, bestimmt, ob der Zähler Bytes oder Instanzvariable zählt. Deswegen kann man als Interface zum Objektspeicher die beiden folgenden Funktionen vorsehen:<br>
<code>ObjRef newPrimitiveObject(int numBytes);</code><br>
<code>ObjRef newCompoundObject(int numObjRefs);</code><br>
Dann realisieren Sie <code>new</code>, <code>getf</code> und <code>putf</code>. Denken Sie daran, alle Instanzvariablen mit <code>nil</code> zu initialisieren! Als nächstes kommen die Instruktionen für Arrays an die Reihe; bitte auch hier die Initialisierung nicht vergessen. Und wo wir schon dabei sind: die lokalen Variablen einer Methode müssen ebenfalls mit <code>nil</code> initialisiert werden, genauso wie die globalen Variablen. Noch ein Hinweis: Ihre VM muss erkennen, wenn auf ein Objekt zugegriffen werden soll, aber nur eine <code>nil</code>-Referenz vorliegt. Ebenso müssen Sie einen Zugriff auf ein Array mit unzulässigem Index abfangen. Testen Sie alle Befehle und Fehlerbedingungen ausführlich! Vergessen Sie nicht die Instruktion <code>getsz</code> zum Bestimmen der Größe eines Objektes, sowie die Instruktionen zu den Referenzvergleichen!<br>
<br>
4. Passen Sie Ihren Debugger der veränderten Situation an. Insbesondere die Inspektion von Objekten wird wahrscheinlich auf das MSB des Zählers Rücksicht nehmen müssen.<br>
<br>
5. Natürlich gibt&#8217;s einen erweiterten <a href="a7/njc">Compiler</a> , der mit Records und Arrays umgehen kann (dazu die <a href="a7/grammar">Grammatik</a> , die <a href="a7/tokens">Tokens</a> , und die <a href="a7/predef">vordefinierten Bezeichner</a> ), sowie einen passenden <a href="a7/nja">Assembler</a> , der die neuen Instruktionen assemblieren kann.<br>
<br>
6. Hier wie immer die Referenzimplementierung:<br>
<a href="a7/njvm">njvm</a></p>
</div>
<div class="sect2">
<h3 id="_vollständige_liste_der_instruktionen_der_vm">Vollständige Liste der Instruktionen der VM</h3>
<table id="a7_instructions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Tabelle 5. VM Instruktionen</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruktion</th>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Stack Layout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>halt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushc &lt;const&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1+n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1-n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1*n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>div</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1/n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1%n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wrint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdchr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wrchr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushg &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popg  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asf   &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>13</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rsf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>14</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushl &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popl  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... value  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>17</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1==n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ne</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>18</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1!=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>19</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&lt;n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>le</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&lt;=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>21</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&gt;n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>22</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n1 n2  -&gt;  ... n1&gt;=n2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jmp   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>23</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brf   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... b  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brt   &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... b  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call  &lt;target&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>26</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... ra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>27</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... ra  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>drop  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>28</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... a0 a1...an-1  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>29</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  -&gt;  ... rv</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>popr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>30</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... rv  -&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>31</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... n -&gt; ... n n</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>new   &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  --&gt;  ... object</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getf  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>33</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... object  --&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>putf  &lt;n&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>34</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... object value  --&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>newa</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>35</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... number_elements  --&gt;  ... array</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getfa</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>36</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... array index  --&gt;  ... value</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>putfa</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>37</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... array index value  --&gt;  ...</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getsz</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>38</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... object  --&gt;  ... number_fields</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pushn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>39</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...  --&gt;  ... nil</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>refeq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>40</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>... ref1 ref2  --&gt;  ... ref1==ref2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>refne</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>41</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+&#8230;&#8203; ref1 ref2  -&#8594;  &#8230;&#8203; ref1!=ref2 +</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_aufgaben_für_tests">Aufgaben für Tests</h3>
<div class="paragraph">
<p>a) Entwerfen Sie eine Datenstruktur zum Speichern von Bäumen für arithmetische Ausdrücke in Ninja (ganz so, wie wir das in der Vorlesung für C gemacht haben). Stellen Sie die entsprechenden Konstruktoren bereit, sowie eine Methode, die einen Baum mit korrekter Einrückung ausgibt. Überprüfen Sie Ihr Programm mit dem Ausdruck <code>5 - (1 + 3) * (4 - 7)</code>: diese <a href="a7/tree1">Konstruktoraufrufe</a> sollten einen Baum erzeugen, der, wenn er ausgegeben wird, diese <a href="a7/tree1">Ausgabe</a> produzieren sollte. Nein, das ist kein Fehler in der Aufgabenstellung&#8230;&#8203; ;-)<br>
<br>
b) Ersetzen Sie die Ausgabe in a) durch eine Auswertefunktion ("Evaluator"). Kommt bei dem o.g. Beispiel wirklich <code>17</code> heraus?<br>
<br>
c) Ersetzen Sie jetzt den Evaluator aus b) durch eine Prozedur zum Erzeugen von Ninja-Assembler. Wenn Sie den erzeugten Code für das o.g. Beispiel assemblieren und ausführen lassen, kommt dann wieder <code>17</code> heraus?</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ksp_aufgabe_8">KSP Aufgabe 8</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Statten Sie Ihre VM mit einem kompaktierenden Garbage-Collector nach dem "Stop &amp; Copy"-Verfahren aus!</p>
</div>
<div class="sect2">
<h3 id="_vorbereitungen">Vorbereitungen</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Legen Sie beim Programmstart den Stack dynamisch mit <code>malloc()</code> an. Sehen Sie eine Kommandozeilenoption <code>--stack n</code> vor, die einen Stack mit n KiB bereitstellt (ACHTUNG: n * 1024 Bytes, NICHT Stack Slots, NICHT n * 1000 Bytes). Der Defaultwert soll n = 64 sein, falls diese Kommandozeilenoption nicht angegeben wird. Hinweis: Sie werden möglicherweise Ihren Test auf Stackoverflow anpassen müssen!</p>
</li>
<li>
<p>Legen Sie beim Programmstart mit <code>malloc()</code> dynamisch einen eigenen Heap an, dessen Größe man durch die Kommandozeilenoption <code>--heap n</code> festlegen kann. Dabei soll n die Gesamtgröße des Heaps in KiB sein (ACHTUNG: n * 1024 Bytes, NICHT n * 1000 Bytes). Der Defaultwert soll n = 8192 sein, falls diese Kommandozeilenoption nicht angegeben wird.</p>
</li>
<li>
<p>Teilen Sie den Heap in zwei gleich große Hälften. Ändern Sie das Anlegen von Objekten so ab, dass Sie den benötigten Speicherplatz fortlaufend von einer Hälfte des Heaps nehmen. Brechen Sie Ihr Programm ab, wenn diese Hälfte erschöpft ist.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_garbage_collector">Garbage Collector</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Programmieren Sie einen kompaktierenden Garbage-Collector nach dem Verfahren "Stop &amp; Copy", der anstelle des Programmabbruchs einen Sammeldurchlauf ausführt. Steht nach dem Durchlauf immer noch nicht genügend Platz für die verlangte Allokation zur Verfügung, sollte Ihre VM mit einer passenden Fehlermeldung terminieren. Hinweise: Als "Broken Heart Flag" lässt sich sehr gut das zweithöchste Bit der <code>size</code>-Komponente benutzen. Der eigentliche "Forward Pointer" (= Byte-Offset in den Zielhalbspeicher, wo sich das kopierte Objekt befindet) belegt die restlichen 30 Bits. Das geht problemlos, da die <code>size</code>-Komponente bei bereits kopierten Objekten nicht mehr benötigt wird. Die Zeiger zu den "Root-Objekten" findet man an allen Stellen in unserer VM, die Objektreferenzen halten: der statische Datenbereich, das Return-Value-Register, diejenigen Stack-Slots, die auf Objekte verweisen, und - nicht vergessen! - die vier Komponenten des Big-Integer-Prozessors <code>bip</code>.</p>
</li>
<li>
<p>Da man beim Integrieren eines Garbage-Collectors leicht einmal einen eigentlich zu verfolgenden Zeiger vergessen kann, stellen Sie eine Kommandozeilenoption <code>--gcpurge</code> zur Verfügung, die bewirkt, dass direkt nach einem Sammeldurchlauf der alte Halbspeicher mit Nullen überschrieben wird. So sollten sich Fehler der genannten Art schneller bemerkbar machen.</p>
</li>
<li>
<p>Instrumentieren Sie Ihren Garbage-Collector so, dass man mit der Kommandozeilenoption <code>--gcstats</code> beim Sammeldurchlauf die folgenden Werte angezeigt bekommt: Anzahl der seit dem letzten Durchlauf angelegten Objekte (sowie die davon belegte Zahl von Bytes), Anzahl lebender Objekte (sowie die davon belegte Zahl von Bytes), freier Platz nach dem Sammeldurchlauf (Bytes im momentan benutzten Halbspeicher). Sie sollten nach dem Ausführen der <code>halt</code>-Instruktion den Garbage-Collector einmal explizit aufrufen, damit man auch für kleine Programme mit wenig Speicherbedarf, die den GC sonst nicht triggern würden, diese statistischen Angaben erhält.</p>
</li>
<li>
<p>Der <a href="a8/instrs">Instruktionssatz</a> ist gegenüber Aufgabe 7 unverändert; auch der <a href="a8/njc">Compiler</a> und der <a href="a8/nja">Assembler</a> bleiben exakt gleich (bis auf die Versionsnummern).</p>
</li>
<li>
<p>Hier nun die endgültige Version der Referenzimplementierung:
<a href="a8/njvm">njvm</a></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_testprogramme_2">Testprogramme</h3>
<div class="paragraph">
<p>Die folgenden zwei etwas größeren Testprogramme muss Ihre VM (bei verschiedenen Heapgrößen) fehlerlos ausführen; dann wird sie mit guter Wahrscheinlichkeit auch als Hausübung akzeptiert.</p>
</div>
<div class="sect3">
<h4 id="_die_faktorisierung_großer_zahlen">Die Faktorisierung großer Zahlen</h4>
<div class="paragraph">
<p><a href="a8/factor.nj">Dieses Ninja-Programm</a> hilft, die folgende Frage zu beantworten: Gegeben sind die Zahlen \(10^n+1\) bei \(n = 1, \ldots, 30\). Was sind die Primfaktoren jeder Zahl?<br>
<br>
Bemerkung: Man muss hier zwischen Tests auf Zusammengesetztheit, Primalitätsbeweisen und Methoden zur Faktorisierung unterscheiden. Es gibt verschiedene Algorithmen in jedem der drei Gebiete. Ein gutes Buch, das auch diese Themen behandelt, ist [Henry Cohen: <em>A Course in Computational Algebraic Number Theory</em>, Springer 1993].</p>
</div>
</div>
<div class="sect3">
<h4 id="_ein_kleines_computeralgebra_system">Ein kleines Computeralgebra-System</h4>
<div class="paragraph">
<p>Computeralgebra-Systeme werden in ihrem Kern oft als Interpreter in einer LISP-ähnlichen Sprache implementiert. Deshalb wird hier <a href="a8/njlisp.nj">njlisp</a> zur Verfügung gestellt, eine Re-Implementierung des alten muLISP-80-Systems in Ninja. Der Makefile dient zum Zusammenbauen und Laufenlassen. Da das System auf mehreren Ebenen interpretiert abläuft, und diese Interpreter alle geladen werden müssen, folgt eine kurze Erklärung der Makefile-Targets, jeweils zusammen mit einem kleinen Beispiel:</p>
</div>
<div class="paragraph">
<p>1) <code>make</code> &#8594; erzeugt die Binärdatei <code>njlisp.bin</code>.</p>
</div>
<div class="paragraph">
<p>2) <code>make run</code> &#8594; lässt <code>njlisp</code> laufen. Probieren Sie als Eingaben:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>(PLUS 3 4)</code></p>
</li>
<li>
<p><code>(TIMES (PLUS 3 4) (DIFFERENCE 10 7))</code></p>
</li>
<li>
<p><code>(PUTD (QUOTE SQUARE) (QUOTE (LAMBDA (X) (TIMES X X))))</code></p>
</li>
<li>
<p><code>(SQUARE 12345)</code></p>
</li>
<li>
<p><code>(SQUARE (SQUARE (SQUARE 12345)))</code></p>
</li>
<li>
<p><code>(OBLIST)</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>3) <code>make musimp</code> &#8594; lässt <code>njlisp</code> laufen und lädt das LISP-Programm <code>musimp.lsp</code>, das die mathematische Notation von Ausdrücken erlaubt und eine eigene Programmiersprache (mit gefälligerer Syntax als LISP) zur Verfügung stellt. Es werden dann interaktiv Eingaben erwartet, die berechnet und ausgegeben werden. Probieren Sie als Eingaben:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>123456789*987654321;</code></p>
</li>
<li>
<p><code>1-2*3+4*5;</code></p>
</li>
<li>
<p><code>FUNCTION F(N), WHEN N=0 OR N=1, N EXIT, F(N-1)+F(N-2) ENDFUN;</code></p>
</li>
<li>
<p><code>F(10);</code></p>
</li>
<li>
<p><code>FUNCTION G(N), A:0, B:1, LOOP WHEN N=0, A EXIT, H:A+B, A:B, B:H, N:N-1 ENDLOOP ENDFUN;</code></p>
</li>
<li>
<p><code>G(100);</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>4) <code>make mumath</code>: lädt nach <code>musimp.lsp</code> auch noch die Mathematik-Module <code>arith.mus</code> (rationale Arithmetik) und <code>algebra.ari</code> (elementare Algebra). Probieren Sie als Eingaben:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>5/9 + 7/12;</code></p>
</li>
<li>
<p><code>((236 - 3*127) * -13) ^ 16;</code></p>
</li>
<li>
<p><code>GCD(861, 1827);</code></p>
</li>
<li>
<p><code>(-24) ^ (1/3);</code></p>
</li>
<li>
<p><code>(-4) ^ (1/2);</code></p>
</li>
<li>
<p><code>#E ^ (3 * #I * #PI / 2);</code></p>
</li>
<li>
<p><code>5*X^2/X - 3*X^1;</code></p>
</li>
<li>
<p><code>(5*X)^3 / X;</code></p>
</li>
<li>
<p><code>EXPD((3*Y^2 - 2*Y + 5)^3);</code></p>
</li>
<li>
<p><code>FCTR(6*X^2*Y - 4*X*Y^2/Z);</code></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Anmerkung"></i>
</td>
<td class="content">
Das ist nur ein kleiner Ausschnitt aus dem Funktionsumfang des damaligen Systems, das auf Mikrocomputern mit maximal 64 KiB (!) Hauptspeicher lief. Es gab ca. 15 Pakete (wie die oben benutzten <code>arith.mus</code> und <code>algebra.ari</code>), die Aufgaben aus den Bereichen Matrizen, Gleichungen, Trigonometrie, Logarithmen, Differential- und Integralrechnung sowie Summen- und Grenzwertbildung lösen konnten.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Zuletzt aktualisiert 2020-11-04 14:54:33 +0100
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>